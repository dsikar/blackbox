# Black Box Recorder

These scripts are compatible with Python 2.7.13

## Installating scripts on Windows 7 (might work on Windows 10 TBC)

1. Clone this repository
2. Install Python 2.7.13
Download .msi installer from:
```
https://www.python.org/downloads/release/python-2713/
```
3. Add python27 to PATH - local and system environment variables
```
C:\Python27\;C:\Python27\Scripts\
```
3.5 On a Windows command prompt, verify Python version
```
python --version
# expected output
Python 2.7.13
```
4. On a Windows command prompt, install pyserial
```
python -m pip install --trusted-host pypi.python.org --trusted-host files.pythonhosted.org pyserial==3.2.1 --verbose
```
5. Connect panel COM2 to PC
6. Verify PC COM port on Device Manager
7. Edit packetizer/pointinfotest.py to match COM port e.g. COM4
8. Run service loop script
```
python service-loop.py
# expected output

C:\Users\dsikar\Documents\blackbox>python service-loop.py
Logging Panel PI id: PANEL_ID_001
TODO scan devices, decode packets

Logging Panel PI id: PANEL_ID_001
TODO scan devices, decode packets



0x1,0xf,0x35,0xe4,0x0,0x0,0xfd,0x12,0x0,0x4,0x0,0x95,0x0,0x0,0x0,0xc,0x1,0x0,0x1,0x0,0x1,0x67,0x81,0x0,0x2,0x0,0x1,0xfe,0x1,0x14,0x67,0x10,0x0,0x47,0x0,0x0,0x0,
0x0,0x9,0x1,0x9,0x0,0x47,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xf5,

0x1,0x0,0x35,0xe4,0x0,0x0,0xfd,0x12,0x0,0x4,0x0,0x95,0x0,0x0,0x0,0xc,0x1,0x0,0x1,0x0,0x1,0x67,0x81,0x0,0x2,0x0,0x1,0xfe,0x1,0x14,0x67,0x10,0x0,0x47,0x0,0x0,0x0,
0x0,0x9,0x1,0x9,0x0,0x47,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xe6,

0x1,0x1,0x35,0xe4,0x0,0x0,0xfd,0x12,0x0,0x4,0x0,0x95,0x0,0x0,0x0,0xc,0x1,0x0,0x1,0x0,0x1,0x67,0x81,0x0,0x2,0x0,0x1,0xfe,0x1,0x14,0x67,0x10,0x0,0x47,0x0,0x0,0x0,
0x0,0x9,0x1,0x9,0x0,0x47,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xe7,

0x1,0x2,0x35,0xe4,0x0,0x0,0xfd,0x12,0x0,0x4,0x0,0x95,0x0,0x0,0x0,0xc,0x1,0x0,0x1,0x0,0x1,0x67,0x81,0x0,0x2,0x0,0x1,0xfe,0x1,0x14,0x67,0x10,0x0,0x47,0x0,0x0,0x0,
0x0,0x9,0x1,0x9,0x0,0x47,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xe8,

0x1,0x3,0x35,0xe4,0x0,0x0,0xfd,0x12,0x0,0x4,0x0,0x95,0x0,0x0,0x0,0xc,0x1,0x0,0x1,0x0,0x1,0x67,0x81,0x0,0x2,0x0,0x1,0xfe,0x1,0x14,0x67,0x10,0x0,0x47,0x0,0x0,0x0,
0x0,0x9,0x1,0x9,0x0,0x47,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xe9,
```
## Running on the Raspberry Pi

1. Clone this repository
2. Edit config.py, setting IS_RUNNING_ON_PI = True
3. If using crontab, make sure the path reference in service-check.sh is correct e.g.
```
/home/pi/blackbox/service-loop.py
```
if the repository was cloned in /home/pi
4. Edit crontab to point to the correct path e.g.
```
* * * * * /home/pi/blackbox/service-check.sh
```

### Debugging on the Raspberry Pi

1. Stop the crontab by adding a # sign at the start of the line:
```
# * * * * * /home/pi/blackbox/service-check.sh
```
2. Kill any service-loop.py processes
```
$ pgrep -f service-loop
<SERVICE ID>
$ sudo kill -9 <SERVICE ID>
```
3. Run the service loop manually
```
$ python service-loop.py
```
4. When debugging is complete, reactivate the crontab by removing the # symbol from the last line (uncommenting crontab entry).
